<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Borehole Schematic Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .borehole-container {
            position: relative;
            margin-left: 60px;
            height: 100%;
            width: calc(100% - 60px);
        }
        
        .depth-scale {
            position: absolute;
            left: -60px;
            width: 60px;
            height: 100%;
            border-right: 1px solid #e5e7eb;
            background-color: #f9fafb;
        }
        
        .depth-marker {
            position: absolute;
            right: 8px;
            font-size: 0.75rem;
            color: #555;
        }
        
        .geology-left, .geology-right {
            position: absolute;
            height: 100%;
            background-color: #f9fafb;
        }
        
        .geology-left {
            left: 0;
            width: calc(50% - 80px);
        }
        
        .geology-right {
            right: 0;
            width: calc(50% - 80px);
        }
        
        .bore-construction {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 100%;
            z-index: 2;
        }
        
        .annulus-construction {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 100%;
            z-index: 1;
        }
        
        .water-level {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            z-index: 4;
        }
        
        .layer-segment {
            position: relative;
            width: 100%;
            transition: all 0.2s ease;
        }
        
        .layer-segment:hover {
            opacity: 0.8;
        }
        
        .segment-label {
            position: absolute;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            font-size: 0.6rem;
            color: white;
            text-shadow: 1px 1px 1px rgba(0,0,0,0.5);
            white-space: nowrap;
            pointer-events: none;
        }
        
        .water-level-label {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            font-size: 0.7rem;
            color: #0077FF;
            text-shadow: 1px 1px 1px rgba(255,255,255,0.5);
            white-space: nowrap;
            background-color: rgba(255,255,255,0.7);
            padding: 0 4px;
            border-radius: 3px;
        }
        
        .right-label {
            position: absolute;
            right: -120px;
            font-size: 0.75rem;
            color: #555;
            white-space: nowrap;
            width: 110px;
        }
        
        .color-preview {
            width: 20px;
            height: 20px;
            border-radius: 4px;
            display: inline-block;
            margin-right: 8px;
            vertical-align: middle;
            border: 1px solid #ddd;
        }
        
        /* Construction patterns */
        .headworks-pattern {
            background-color: #8B4513;
            background-image: linear-gradient(45deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent);
            background-size: 10px 10px;
        }
        
        .surface-casing-pattern {
            background-color: #A0522D;
            background-image: linear-gradient(135deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent);
            background-size: 10px 10px;
        }
        
        .blank-casing-pattern {
            background-color: #CD853F;
            background-image: linear-gradient(0deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent);
            background-size: 10px 10px;
        }
        
        .slotted-casing-1-pattern {
            background-color: #D2691E;
            background-image: linear-gradient(90deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent);
            background-size: 10px 10px;
        }
        
        .screens-pattern {
            background-color: #B8860B;
            background-image: 
                linear-gradient(45deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent),
                linear-gradient(-45deg, rgba(255,255,255,0.2) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.2) 50%, rgba(255,255,255,0.2) 75%, transparent 75%, transparent);
            background-size: 10px 10px;
        }
        
        .slotted-casing-2-pattern {
            background-color: #DAA520;
            background-image: linear-gradient(0deg, rgba(255,255,255,0.2) 2px, transparent 2px, transparent 4px, rgba(255,255,255,0.2) 4px, rgba(255,255,255,0.2) 6px, transparent 6px);
            background-size: 10px 10px;
        }
        
        .sump-pattern {
            background-color: #F4A460;
            background-image: linear-gradient(90deg, rgba(255,255,255,0.2) 2px, transparent 2px, transparent 4px, rgba(255,255,255,0.2) 4px, rgba(255,255,255,0.2) 6px, transparent 6px);
            background-size: 10px 10px;
        }
        
        .endcap-pattern {
            background-color: #BC8F8F;
            background-image: 
                linear-gradient(0deg, rgba(255,255,255,0.2) 2px, transparent 2px, transparent 4px, rgba(255,255,255,0.2) 4px, rgba(255,255,255,0.2) 6px, transparent 6px),
                linear-gradient(90deg, rgba(255,255,255,0.2) 2px, transparent 2px, transparent 4px, rgba(255,255,255,0.2) 4px, rgba(255,255,255,0.2) 6px, transparent 6px);
            background-size: 10px 10px;
        }
        
        /* Annulus patterns */
        .grout-pattern {
            background-color: #6B7280;
            background-image: 
                linear-gradient(45deg, rgba(255,255,255,0.3) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0.3) 75%, transparent 75%, transparent),
                linear-gradient(-45deg, rgba(255,255,255,0.3) 25%, transparent 25%, transparent 50%, rgba(255,255,255,0.3) 50%, rgba(255,255,255,0.3) 75%, transparent 75%, transparent);
            background-size: 10px 10px;
        }
        
        .gravel-pattern {
            background-color: #92400E;
            background-image: 
                radial-gradient(circle, rgba(255,255,255,0.3) 20%, transparent 20%),
                radial-gradient(circle, rgba(255,255,255,0.3) 20%, transparent 20%);
            background-size: 10px 10px;
            background-position: 0 0, 5px 5px;
        }
        
        .bentonite-pattern {
            background-color: #3F6212;
            background-image: 
                linear-gradient(0deg, rgba(255,255,255,0.3) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.3) 1px, transparent 1px);
            background-size: 5px 5px;
        }
        
        .ground-level {
            position: absolute;
            left: 0;
            right: 0;
            border-top: 2px dashed #555;
            z-index: 10;
        }
        
        .ground-level-label {
            position: absolute;
            left: -60px;
            font-size: 0.7rem;
            color: #555;
            background-color: rgba(255,255,255,0.7);
            padding: 0 4px;
            border-radius: 3px;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <header class="mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">Borehole Schematic Generator</h1>
            <p class="text-gray-600">Visualize geological layers and construction details in a borehole</p>
        </header>

        <!-- Borehole Details Container -->
        <div class="bg-white rounded-lg shadow p-6 mb-8">
            <h2 class="text-xl font-semibold mb-4 text-gray-700">Borehole Details</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div>
                    <label for="holeType" class="block text-sm font-medium text-gray-700 mb-1">Hole Type</label>
                    <select id="holeType" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                        <option value="Hydrogeology">Hydrogeology</option>
                        <option value="Diamond Drilling">Diamond Drilling</option>
                        <option value="RC Drilling">RC Drilling</option>
                    </select>
                </div>
                <div>
                    <label for="totalHoleDepth" class="block text-sm font-medium text-gray-700 mb-1">Total Depth (m)</label>
                    <input type="number" id="totalHoleDepth" step="0.5" min="0" value="30" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                </div>
                <div>
                    <label for="waterDepth" class="block text-sm font-medium text-gray-700 mb-1">Water Depth (m)</label>
                    <input type="number" id="waterDepth" step="0.5" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                </div>
                <div class="flex items-end">
                    <button id="updateBoreholeDetails" class="w-full bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                        <i class="fas fa-sync-alt mr-2"></i> Update
                    </button>
                </div>
            </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-8">
            <!-- Layer Information Form -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Layer Information</h2>
                
                <form id="layerForm" class="space-y-4">
                    <div>
                        <label for="fromDepth" class="block text-sm font-medium text-gray-700 mb-1">From Depth (m)</label>
                        <input type="number" id="fromDepth" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    
                    <div>
                        <label for="toDepth" class="block text-sm font-medium text-gray-700 mb-1">To Depth (m)</label>
                        <input type="number" id="toDepth" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    
                    <div>
                        <label for="materialType" class="block text-sm font-medium text-gray-700 mb-1">Material Type</label>
                        <select id="materialType" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="" disabled selected>Select a material type</option>
                            <option value="Detritals" data-color="#FF5733">Detritals</option>
                            <option value="Pisolites" data-color="#33FF57">Pisolites</option>
                            <option value="Calcrete" data-color="#3357FF">Calcrete</option>
                            <option value="Clay" data-color="#F0FF33">Clay</option>
                            <option value="Channel Iron Deposits" data-color="#FF33F0">Channel Iron Deposits</option>
                            <option value="Footwall Zone" data-color="#33FFF0">Footwall Zone</option>
                            <option value="Boolgeeda Iron Formation" data-color="#FF338A">Boolgeeda Iron Formation</option>
                            <option value="Woongarra Rhyolite" data-color="#8AFF33">Woongarra Rhyolite</option>
                            <option value="Weeli Wolli Formation" data-color="#338AFF">Weeli Wolli Formation</option>
                            <option value="Brockman Iron Formation" data-color="#FF5733">Brockman Iron Formation</option>
                            <option value="Mt McRae Shale" data-color="#57FF33">Mt McRae Shale</option>
                            <option value="Mt Sylvia Formation" data-color="#3357FF">Mt Sylvia Formation</option>
                            <option value="Wittenoom Formation" data-color="#F0FF33">Wittenoom Formation</option>
                            <option value="Marra Mamba Formation" data-color="#FF33F0">Marra Mamba Formation</option>
                            <option value="Yandicoogina Shale Member" data-color="#33FFF0">Yandicoogina Shale Member</option>
                            <option value="Joffe Member" data-color="#8A33FF">Joffe Member</option>
                            <option value="Mt Whaleback Shale Member" data-color="#FF8A33">Mt Whaleback Shale Member</option>
                            <option value="Dales Gorge Member" data-color="#33FF8A">Dales Gorge Member</option>
                            <option value="Bee Gorge Member" data-color="#FF338A">Bee Gorge Member</option>
                            <option value="Paraburdoo Member" data-color="#8AFF33">Paraburdoo Member</option>
                            <option value="West Angela Member" data-color="#338AFF">West Angela Member</option>
                            <option value="Mount Newman Formation" data-color="#FF5733">Mount Newman Formation</option>
                            <option value="MacLeod Member" data-color="#57FF33">MacLeod Member</option>
                            <option value="Nammuldi Member" data-color="#3357FF">Nammuldi Member</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="layerColor" class="block text-sm font-medium text-gray-700 mb-1">Layer Color</label>
                        <div class="flex items-center">
                            <input type="color" id="layerColor" value="#33FF57" class="w-10 h-10 mr-2">
                            <div id="colorPreview" class="color-preview" style="background-color: #33FF57;"></div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 pt-2">
                        <button type="submit" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <i class="fas fa-layer-group mr-2"></i> Add Layer
                        </button>
                        <button type="button" id="clearAllLayers" class="bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                            <i class="fas fa-trash-alt mr-2"></i> Clear All
                        </button>
                    </div>
                </form>
                
                <div class="mt-6">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Current Layers</h3>
                    <div id="layerList" class="border rounded-md divide-y divide-gray-200 max-h-60 overflow-y-auto">
                        <div class="p-3 text-center text-gray-500">No layers added yet</div>
                    </div>
                </div>
            </div>
            
            <!-- Bore Construction Form -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Bore Construction</h2>
                
                <form id="constructionForm" class="space-y-4">
                    <div>
                        <label for="constructionType" class="block text-sm font-medium text-gray-700 mb-1">Construction Type</label>
                        <select id="constructionType" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="" disabled selected>Select construction type</option>
                            <option value="Headworks" data-color="#8B4513">Headworks</option>
                            <option value="Surface Casing" data-color="#A0522D">Surface Casing</option>
                            <option value="Blank Casing" data-color="#CD853F">Blank Casing</option>
                            <option value="Slotted Casing 1" data-color="#D2691E">Slotted Casing 1</option>
                            <option value="Screens" data-color="#B8860B">Screens</option>
                            <option value="Slotted Casing 2" data-color="#DAA520">Slotted Casing 2</option>
                            <option value="Sump" data-color="#F4A460">Sump</option>
                            <option value="Endcap" data-color="#BC8F8F">Endcap</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="constructionFromDepth" class="block text-sm font-medium text-gray-700 mb-1">From Depth (m)</label>
                        <input type="number" id="constructionFromDepth" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    
                    <div>
                        <label for="constructionToDepth" class="block text-sm font-medium text-gray-700 mb-1">To Depth (m)</label>
                        <input type="number" id="constructionToDepth" step="0.5" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    
                    <div>
                        <label for="constructionColor" class="block text-sm font-medium text-gray-700 mb-1">Color</label>
                        <div class="flex items-center">
                            <input type="color" id="constructionColor" value="#8B4513" class="w-10 h-10 mr-2">
                            <div id="constructionColorPreview" class="color-preview" style="background-color: #8B4513;"></div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 pt-2">
                        <button type="submit" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <i class="fas fa-hammer mr-2"></i> Add Construction
                        </button>
                        <button type="button" id="clearAllConstruction" class="bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                            <i class="fas fa-trash-alt mr-2"></i> Clear All
                        </button>
                    </div>
                </form>
                
                <div class="mt-6">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Current Construction</h3>
                    <div id="constructionList" class="border rounded-md divide-y divide-gray-200 max-h-60 overflow-y-auto">
                        <div class="p-3 text-center text-gray-500">No construction added yet</div>
                    </div>
                </div>
            </div>
            
            <!-- Annulus Construction Form -->
            <div class="bg-white rounded-lg shadow p-6">
                <h2 class="text-xl font-semibold mb-4 text-gray-700">Annulus Construction</h2>
                
                <form id="annulusForm" class="space-y-4">
                    <div>
                        <label for="annulusType" class="block text-sm font-medium text-gray-700 mb-1">Annulus Type</label>
                        <select id="annulusType" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="" disabled selected>Select annulus type</option>
                            <option value="Grout" data-color="#6B7280">Grout</option>
                            <option value="Gravel" data-color="#92400E">Gravel</option>
                            <option value="Bentonite" data-color="#3F6212">Bentonite</option>
                        </select>
                    </div>
                    
                    <div>
                        <label for="annulusFromDepth" class="block text-sm font-medium text-gray-700 mb-1">From Depth (m)</label>
                        <input type="number" id="annulusFromDepth" step="0.5" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    
                    <div>
                        <label for="annulusToDepth" class="block text-sm font-medium text-gray-700 mb-1">To Depth (m)</label>
                        <input type="number" id="annulusToDepth" step="0.5" min="0" class="w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    
                    <div>
                        <label for="annulusColor" class="block text-sm font-medium text-gray-700 mb-1">Color</label>
                        <div class="flex items-center">
                            <input type="color" id="annulusColor" value="#6B7280" class="w-10 h-10 mr-2">
                            <div id="annulusColorPreview" class="colorPreview" style="background-color: #6B7280;"></div>
                        </div>
                    </div>
                    
                    <div class="flex space-x-3 pt-2">
                        <button type="submit" class="flex-1 bg-indigo-600 text-white py-2 px-4 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                            <i class="fas fa-fill-drip mr-2"></i> Add Annulus
                        </button>
                        <button type="button" id="clearAllAnnulus" class="bg-gray-200 text-gray-700 py-2 px-4 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500">
                            <i class="fas fa-trash-alt mr-2"></i> Clear All
                        </button>
                    </div>
                </form>
                
                <div class="mt-6">
                    <h3 class="text-lg font-medium text-gray-700 mb-2">Current Annulus</h3>
                    <div id="annulusList" class="border rounded-md divide-y divide-gray-200 max-h-60 overflow-y-auto">
                        <div class="p-3 text-center text-gray-500">No annulus added yet</div>
                    </div>
                </div>
            </div>
            
            <!-- Borehole Visualization -->
            <div class="bg-white rounded-lg shadow p-6 lg:col-span-2">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-semibold text-gray-700">Borehole Schematic</h2>
                    <div class="flex space-x-2">
                        <button id="zoomIn" class="bg-gray-100 p-2 rounded-md hover:bg-gray-200">
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button id="zoomOut" class="bg-gray-100 p-2 rounded-md hover:bg-gray-200">
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button id="exportBtn" class="bg-indigo-100 text-indigo-700 p-2 rounded-md hover:bg-indigo-200">
                            <i class="fas fa-download mr-1"></i> Export
                        </button>
                    </div>
                </div>
                
                <div class="border rounded-md p-4 bg-gray-50">
                    <div class="relative" style="height: 600px; overflow-y: auto;">
                        <div id="boreholeContainer" class="borehole-container">
                            <!-- Depth scale on the left -->
                            <div id="depthScale" class="depth-scale"></div>
                            
                            <!-- Geology on the left -->
                            <div id="geologyLeft" class="geology-left"></div>
                            
                            <!-- Annulus construction (wider than bore construction) -->
                            <div id="annulusConstruction" class="annulus-construction"></div>
                            
                            <!-- Bore construction in the center -->
                            <div id="boreConstruction" class="bore-construction"></div>
                            
                            <!-- Water level -->
                            <div id="waterLevel" class="water-level"></div>
                            
                            <!-- Geology on the right -->
                            <div id="geologyRight" class="geology-right"></div>
                            
                            <!-- Ground level indicator -->
                            <div id="groundLevel" class="ground-level"></div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-4 flex justify-between items-center">
                    <div class="text-sm text-gray-500">
                        <span id="totalDepth">Total depth: 30 m</span>
                    </div>
                    <div class="text-sm">
                        <button id="editModeBtn" class="text-indigo-600 hover:text-indigo-800">
                            <i class="fas fa-edit mr-1"></i> Edit Mode
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // DOM Elements
            const layerForm = document.getElementById('layerForm');
            const totalHoleDepthInput = document.getElementById('totalHoleDepth');
            const waterDepthInput = document.getElementById('waterDepth');
            const fromDepthInput = document.getElementById('fromDepth');
            const toDepthInput = document.getElementById('toDepth');
            const materialTypeSelect = document.getElementById('materialType');
            const layerColorInput = document.getElementById('layerColor');
            const colorPreview = document.getElementById('colorPreview');
            const clearAllLayersBtn = document.getElementById('clearAllLayers');
            const layerList = document.getElementById('layerList');
            
            const constructionForm = document.getElementById('constructionForm');
            const constructionTypeSelect = document.getElementById('constructionType');
            const constructionFromDepthInput = document.getElementById('constructionFromDepth');
            const constructionToDepthInput = document.getElementById('constructionToDepth');
            const constructionColorInput = document.getElementById('constructionColor');
            const constructionColorPreview = document.getElementById('constructionColorPreview');
            const clearAllConstructionBtn = document.getElementById('clearAllConstruction');
            const constructionList = document.getElementById('constructionList');
            
            const annulusForm = document.getElementById('annulusForm');
            const annulusTypeSelect = document.getElementById('annulusType');
            const annulusFromDepthInput = document.getElementById('annulusFromDepth');
            const annulusToDepthInput = document.getElementById('annulusToDepth');
            const annulusColorInput = document.getElementById('annulusColor');
            const annulusColorPreview = document.getElementById('annulusColorPreview');
            const clearAllAnnulusBtn = document.getElementById('clearAllAnnulus');
            const annulusList = document.getElementById('annulusList');
            
            const boreholeContainer = document.getElementById('boreholeContainer');
            const geologyLeft = document.getElementById('geologyLeft');
            const annulusConstruction = document.getElementById('annulusConstruction');
            const boreConstruction = document.getElementById('boreConstruction');
            const waterLevel = document.getElementById('waterLevel');
            const geologyRight = document.getElementById('geologyRight');
            const depthScale = document.getElementById('depthScale');
            const groundLevel = document.getElementById('groundLevel');
            const zoomInBtn = document.getElementById('zoomIn');
            const zoomOutBtn = document.getElementById('zoomOut');
            const exportBtn = document.getElementById('exportBtn');
            const editModeBtn = document.getElementById('editModeBtn');
            const totalDepthSpan = document.getElementById('totalDepth');
            
            // New elements for borehole details
            const holeTypeSelect = document.getElementById('holeType');
            const updateBoreholeDetailsBtn = document.getElementById('updateBoreholeDetails');
            
            // State
            let layers = [];
            let constructionElements = [];
            let annulusElements = [];
            let segmentHeight = 10;
            let isEditMode = false;
            let totalHoleDepth = parseFloat(totalHoleDepthInput.value);
            let waterDepth = null;
            let holeType = holeTypeSelect.value;
            
            // Initialize form fields
            fromDepthInput.value = '0';
            constructionFromDepthInput.value = '0';
            annulusFromDepthInput.value = '0';
            
            // Material type selection changes color
            materialTypeSelect.addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                if (selectedOption.dataset.color) {
                    layerColorInput.value = selectedOption.dataset.color;
                    colorPreview.style.backgroundColor = selectedOption.dataset.color;
                }
            });
            
            // Construction type selection changes color
            constructionTypeSelect.addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                if (selectedOption.dataset.color) {
                    constructionColorInput.value = selectedOption.dataset.color;
                    constructionColorPreview.style.backgroundColor = selectedOption.dataset.color;
                }
            });
            
            // Annulus type selection changes color
            annulusTypeSelect.addEventListener('change', function() {
                const selectedOption = this.options[this.selectedIndex];
                if (selectedOption.dataset.color) {
                    annulusColorInput.value = selectedOption.dataset.color;
                    annulusColorPreview.style.backgroundColor = selectedOption.dataset.color;
                }
            });
            
            // Color input changes preview
            layerColorInput.addEventListener('input', function() {
                colorPreview.style.backgroundColor = this.value;
            });
            
            constructionColorInput.addEventListener('input', function() {
                constructionColorPreview.style.backgroundColor = this.value;
            });
            
            annulusColorInput.addEventListener('input', function() {
                annulusColorPreview.style.backgroundColor = this.value;
            });
            
            // Total hole depth change handler
            totalHoleDepthInput.addEventListener('change', function() {
                totalHoleDepth = parseFloat(this.value);
                if (isNaN(totalHoleDepth) || totalHoleDepth <= 0) {
                    totalHoleDepth = 30;
                    this.value = 30;
                }
            });
            
            // Water depth change handler
            waterDepthInput.addEventListener('change', function() {
                waterDepth = parseFloat(this.value);
                if (isNaN(waterDepth)) {
                    waterDepth = null;
                    this.value = '';
                }
            });
            
            // Hole type change handler
            holeTypeSelect.addEventListener('change', function() {
                holeType = this.value;
            });
            
            // Update borehole details
            updateBoreholeDetailsBtn.addEventListener('click', function() {
                generateBorehole();
            });
            
            // Layer Form submission
            layerForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const fromDepth = parseFloat(fromDepthInput.value);
                const toDepth = parseFloat(toDepthInput.value);
                const materialType = materialTypeSelect.value;
                const color = layerColorInput.value;
                
                if (isNaN(fromDepth) || isNaN(toDepth)) {
                    alert('Please enter valid depth values');
                    return;
                }
                
                if (fromDepth >= toDepth) {
                    alert('"From Depth" must be less than "To Depth"');
                    return;
                }
                
                if (toDepth > totalHoleDepth) {
                    alert('"To Depth" cannot exceed the Total Hole Depth');
                    return;
                }
                
                if (!materialType) {
                    alert('Please select a material type');
                    return;
                }
                
                const newLayer = {
                    id: Date.now(),
                    fromDepth,
                    toDepth,
                    materialType,
                    color
                };
                
                layers.push(newLayer);
                updateLayerList();
                generateBorehole();
                
                // Update From Depth to the To Depth after successful submission
                fromDepthInput.value = toDepth;
                toDepthInput.value = '';
                materialTypeSelect.selectedIndex = 0;
                layerColorInput.value = '#33FF57';
                colorPreview.style.backgroundColor = '#33FF57';
            });
            
            // Construction Form submission
            constructionForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const fromDepth = parseFloat(constructionFromDepthInput.value);
                const toDepth = parseFloat(constructionToDepthInput.value);
                const constructionType = constructionTypeSelect.value;
                const color = constructionColorInput.value;
                
                if (isNaN(fromDepth) || isNaN(toDepth)) {
                    alert('Please enter valid depth values');
                    return;
                }
                
                if (fromDepth >= toDepth) {
                    alert('"From Depth" must be less than "To Depth"');
                    return;
                }
                
                if (constructionType !== 'Headworks' && toDepth > totalHoleDepth) {
                    alert('"To Depth" cannot exceed the Total Hole Depth');
                    return;
                }
                
                if (!constructionType) {
                    alert('Please select a construction type');
                    return;
                }
                
                const newConstruction = {
                    id: Date.now(),
                    fromDepth,
                    toDepth,
                    constructionType,
                    color
                };
                
                constructionElements.push(newConstruction);
                updateConstructionList();
                generateBorehole();
                
                // Update From Depth to the To Depth after successful submission
                constructionFromDepthInput.value = toDepth;
                constructionToDepthInput.value = '';
                constructionTypeSelect.selectedIndex = 0;
                constructionColorInput.value = '#8B4513';
                constructionColorPreview.style.backgroundColor = '#8B4513';
            });
            
            // Annulus Form submission
            annulusForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const fromDepth = parseFloat(annulusFromDepthInput.value);
                const toDepth = parseFloat(annulusToDepthInput.value);
                const annulusType = annulusTypeSelect.value;
                const color = annulusColorInput.value;
                
                if (isNaN(fromDepth) || isNaN(toDepth)) {
                    alert('Please enter valid depth values');
                    return;
                }
                
                if (fromDepth >= toDepth) {
                    alert('"From Depth" must be less than "To Depth"');
                    return;
                }
                
                if (toDepth > totalHoleDepth) {
                    alert('"To Depth" cannot exceed the Total Hole Depth');
                    return;
                }
                
                if (!annulusType) {
                    alert('Please select an annulus type');
                    return;
                }
                
                const newAnnulus = {
                    id: Date.now(),
                    fromDepth,
                    toDepth,
                    annulusType,
                    color
                };
                
                annulusElements.push(newAnnulus);
                updateAnnulusList();
                generateBorehole();
                
                // Update From Depth to the To Depth after successful submission
                annulusFromDepthInput.value = toDepth;
                annulusToDepthInput.value = '';
                annulusTypeSelect.selectedIndex = 0;
                annulusColorInput.value = '#6B7280';
                annulusColorPreview.style.backgroundColor = '#6B7280';
            });
            
            // Clear all layers
            clearAllLayersBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear all layers?')) {
                    layers = [];
                    updateLayerList();
                    generateBorehole();
                    fromDepthInput.value = '0';
                    toDepthInput.value = '';
                }
            });
            
            // Clear all construction
            clearAllConstructionBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear all construction elements?')) {
                    constructionElements = [];
                    updateConstructionList();
                    generateBorehole();
                    constructionFromDepthInput.value = '0';
                    constructionToDepthInput.value = '';
                }
            });
            
            // Clear all annulus
            clearAllAnnulusBtn.addEventListener('click', function() {
                if (confirm('Are you sure you want to clear all annulus elements?')) {
                    annulusElements = [];
                    updateAnnulusList();
                    generateBorehole();
                    annulusFromDepthInput.value = '0';
                    annulusToDepthInput.value = '';
                }
            });
            
            // Zoom controls
            zoomInBtn.addEventListener('click', function() {
                if (segmentHeight < 20) {
                    segmentHeight += 2;
                    generateBorehole();
                }
            });
            
            zoomOutBtn.addEventListener('click', function() {
                if (segmentHeight > 5) {
                    segmentHeight -= 2;
                    generateBorehole();
                }
            });
            
            // Edit mode toggle
            editModeBtn.addEventListener('click', function() {
                isEditMode = !isEditMode;
                editModeBtn.innerHTML = isEditMode 
                    ? '<i class="fas fa-check mr-1"></i> Save Changes' 
                    : '<i class="fas fa-edit mr-1"></i> Edit Mode';
                
                if (!isEditMode) {
                    // Save any changes made in edit mode
                    const editInputs = document.querySelectorAll('.layer-edit-input, .construction-edit-input, .annulus-edit-input');
                    editInputs.forEach(input => {
                        const id = parseInt(input.dataset.id);
                        const property = input.dataset.property;
                        const value = input.value;
                        
                        // Update layers
                        const layer = layers.find(l => l.id === id);
                        if (layer) {
                            if (property === 'fromDepth' || property === 'toDepth') {
                                layer[property] = parseFloat(value);
                            } else {
                                layer[property] = value;
                            }
                        }
                        
                        // Update construction elements
                        const construction = constructionElements.find(c => c.id === id);
                        if (construction) {
                            if (property === 'fromDepth' || property === 'toDepth') {
                                construction[property] = parseFloat(value);
                            } else {
                                construction[property] = value;
                            }
                        }
                        
                        // Update annulus elements
                        const annulus = annulusElements.find(a => a.id === id);
                        if (annulus) {
                            if (property === 'fromDepth' || property === 'toDepth') {
                                annulus[property] = parseFloat(value);
                            } else {
                                annulus[property] = value;
                            }
                        }
                    });
                    
                    generateBorehole();
                }
                
                updateLayerList();
                updateConstructionList();
                updateAnnulusList();
            });
            
            // Export functionality
            exportBtn.addEventListener('click', function() {
                alert('Export functionality would save the borehole schematic as an image or PDF in a real application.');
            });
            
            // Update the layer list display
            function updateLayerList() {
                if (layers.length === 0) {
                    layerList.innerHTML = '<div class="p-3 text-center text-gray-500">No layers added yet</div>';
                    return;
                }
                
                // Sort layers by depth
                const sortedLayers = [...layers].sort((a, b) => a.fromDepth - b.fromDepth);
                
                layerList.innerHTML = '';
                
                sortedLayers.forEach(layer => {
                    const layerElement = document.createElement('div');
                    layerElement.className = 'p-3 hover:bg-gray-50 group';
                    layerElement.dataset.id = layer.id;
                    
                    if (isEditMode) {
                        layerElement.innerHTML = `
                            <div class="grid grid-cols-4 gap-2 items-center">
                                <div>
                                    <label class="text-xs text-gray-500 block">From</label>
                                    <input type="number" step="0.5" value="${layer.fromDepth}" 
                                           data-id="${layer.id}" data-property="fromDepth"
                                           class="layer-edit-input w-full text-sm border rounded p-1">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500 block">To</label>
                                    <input type="number" step="0.5" value="${layer.toDepth}" 
                                           data-id="${layer.id}" data-property="toDepth"
                                           class="layer-edit-input w-full text-sm border rounded p-1">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500 block">Material</label>
                                    <select data-id="${layer.id}" data-property="materialType"
                                            class="layer-edit-input w-full text-sm border rounded p-1">
                                        ${Array.from(materialTypeSelect.options).map(option => 
                                            `<option value="${option.value}" ${option.value === layer.materialType ? 'selected' : ''}
                                             ${option.dataset.color ? `data-color="${option.dataset.color}"` : ''}>
                                                ${option.text}
                                            </option>`
                                        ).join('')}
                                    </select>
                                </div>
                                <div class="flex items-end space-x-2">
                                    <input type="color" value="${layer.color}" 
                                           data-id="${layer.id}" data-property="color"
                                           class="layer-edit-input h-8 w-8">
                                    <button class="delete-layer text-red-500 hover:text-red-700" data-id="${layer.id}">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                    } else {
                        layerElement.innerHTML = `
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="color-preview mr-2" style="background-color: ${layer.color};"></div>
                                    <div>
                                        <div class="font-medium">${layer.materialType}</div>
                                        <div class="text-xs text-gray-500">${layer.fromDepth}m - ${layer.toDepth}m</div>
                                    </div>
                                </div>
                                <button class="delete-layer opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700" data-id="${layer.id}">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        `;
                    }
                    
                    layerList.appendChild(layerElement);
                });
                
                // Add delete event listeners
                document.querySelectorAll('.delete-layer').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.dataset.id);
                        layers = layers.filter(layer => layer.id !== id);
                        updateLayerList();
                        generateBorehole();
                    });
                });
                
                // Add material type change listeners in edit mode
                if (isEditMode) {
                    document.querySelectorAll('select[data-property="materialType"]').forEach(select => {
                        select.addEventListener('change', function() {
                            const selectedOption = this.options[this.selectedIndex];
                            if (selectedOption.dataset.color) {
                                const id = parseInt(this.dataset.id);
                                const layer = layers.find(l => l.id === id);
                                if (layer) {
                                    layer.color = selectedOption.dataset.color;
                                }
                                // Update the color input
                                const colorInput = document.querySelector(`input[data-id="${id}"][data-property="color"]`);
                                if (colorInput) {
                                    colorInput.value = selectedOption.dataset.color;
                                }
                            }
                        });
                    });
                }
            }
            
            // Update the construction list display
            function updateConstructionList() {
                if (constructionElements.length === 0) {
                    constructionList.innerHTML = '<div class="p-3 text-center text-gray-500">No construction added yet</div>';
                    return;
                }
                
                // Sort construction by depth
                const sortedConstruction = [...constructionElements].sort((a, b) => a.fromDepth - b.fromDepth);
                
                constructionList.innerHTML = '';
                
                sortedConstruction.forEach(construction => {
                    const constructionElement = document.createElement('div');
                    constructionElement.className = 'p-3 hover:bg-gray-50 group';
                    constructionElement.dataset.id = construction.id;
                    
                    if (isEditMode) {
                        constructionElement.innerHTML = `
                            <div class="grid grid-cols-4 gap-2 items-center">
                                <div>
                                    <label class="text-xs text-gray-500 block">From</label>
                                    <input type="number" step="0.5" value="${construction.fromDepth}" 
                                           data-id="${construction.id}" data-property="fromDepth"
                                           class="construction-edit-input w-full text-sm border rounded p-1">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500 block">To</label>
                                    <input type="number" step="0.5" value="${construction.toDepth}" 
                                           data-id="${construction.id}" data-property="toDepth"
                                           class="construction-edit-input w-full text-sm border rounded p-1">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500 block">Type</label>
                                    <select data-id="${construction.id}" data-property="constructionType"
                                            class="construction-edit-input w-full text-sm border rounded p-1">
                                        ${Array.from(constructionTypeSelect.options).map(option => 
                                            `<option value="${option.value}" ${option.value === construction.constructionType ? 'selected' : ''}
                                             ${option.dataset.color ? `data-color="${option.dataset.color}"` : ''}>
                                                ${option.text}
                                            </option>`
                                        ).join('')}
                                    </select>
                                </div>
                                <div class="flex items-end space-x-2">
                                    <input type="color" value="${construction.color}" 
                                           data-id="${construction.id}" data-property="color"
                                           class="construction-edit-input h-8 w-8">
                                    <button class="delete-construction text-red-500 hover:text-red-700" data-id="${construction.id}">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                    } else {
                        constructionElement.innerHTML = `
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="color-preview mr-2" style="background-color: ${construction.color};"></div>
                                    <div>
                                        <div class="font-medium">${construction.constructionType}</div>
                                        <div class="text-xs text-gray-500">${construction.fromDepth}m - ${construction.toDepth}m</div>
                                    </div>
                                </div>
                                <button class="delete-construction opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700" data-id="${construction.id}">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        `;
                    }
                    
                    constructionList.appendChild(constructionElement);
                });
                
                // Add delete event listeners
                document.querySelectorAll('.delete-construction').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.dataset.id);
                        constructionElements = constructionElements.filter(construction => construction.id !== id);
                        updateConstructionList();
                        generateBorehole();
                    });
                });
                
                // Add construction type change listeners in edit mode
                if (isEditMode) {
                    document.querySelectorAll('select[data-property="constructionType"]').forEach(select => {
                        select.addEventListener('change', function() {
                            const selectedOption = this.options[this.selectedIndex];
                            if (selectedOption.dataset.color) {
                                const id = parseInt(this.dataset.id);
                                const construction = constructionElements.find(c => c.id === id);
                                if (construction) {
                                    construction.color = selectedOption.dataset.color;
                                }
                                // Update the color input
                                const colorInput = document.querySelector(`input[data-id="${id}"][data-property="color"]`);
                                if (colorInput) {
                                    colorInput.value = selectedOption.dataset.color;
                                }
                            }
                        });
                    });
                }
            }
            
            // Update the annulus list display
            function updateAnnulusList() {
                if (annulusElements.length === 0) {
                    annulusList.innerHTML = '<div class="p-3 text-center text-gray-500">No annulus added yet</div>';
                    return;
                }
                
                // Sort annulus by depth
                const sortedAnnulus = [...annulusElements].sort((a, b) => a.fromDepth - b.fromDepth);
                
                annulusList.innerHTML = '';
                
                sortedAnnulus.forEach(annulus => {
                    const annulusElement = document.createElement('div');
                    annulusElement.className = 'p-3 hover:bg-gray-50 group';
                    annulusElement.dataset.id = annulus.id;
                    
                    if (isEditMode) {
                        annulusElement.innerHTML = `
                            <div class="grid grid-cols-4 gap-2 items-center">
                                <div>
                                    <label class="text-xs text-gray-500 block">From</label>
                                    <input type="number" step="0.5" value="${annulus.fromDepth}" 
                                           data-id="${annulus.id}" data-property="fromDepth"
                                           class="annulus-edit-input w-full text-sm border rounded p-1">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500 block">To</label>
                                    <input type="number" step="0.5" value="${annulus.toDepth}" 
                                           data-id="${annulus.id}" data-property="toDepth"
                                           class="annulus-edit-input w-full text-sm border rounded p-1">
                                </div>
                                <div>
                                    <label class="text-xs text-gray-500 block">Type</label>
                                    <select data-id="${annulus.id}" data-property="annulusType"
                                            class="annulus-edit-input w-full text-sm border rounded p-1">
                                        ${Array.from(annulusTypeSelect.options).map(option => 
                                            `<option value="${option.value}" ${option.value === annulus.annulusType ? 'selected' : ''}
                                             ${option.dataset.color ? `data-color="${option.dataset.color}"` : ''}>
                                                ${option.text}
                                            </option>`
                                        ).join('')}
                                    </select>
                                </div>
                                <div class="flex items-end space-x-2">
                                    <input type="color" value="${annulus.color}" 
                                           data-id="${annulus.id}" data-property="color"
                                           class="annulus-edit-input h-8 w-8">
                                    <button class="delete-annulus text-red-500 hover:text-red-700" data-id="${annulus.id}">
                                        <i class="fas fa-trash-alt"></i>
                                    </button>
                                </div>
                            </div>
                        `;
                    } else {
                        annulusElement.innerHTML = `
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <div class="color-preview mr-2" style="background-color: ${annulus.color};"></div>
                                    <div>
                                        <div class="font-medium">${annulus.annulusType}</div>
                                        <div class="text-xs text-gray-500">${annulus.fromDepth}m - ${annulus.toDepth}m</div>
                                    </div>
                                </div>
                                <button class="delete-annulus opacity-0 group-hover:opacity-100 text-red-500 hover:text-red-700" data-id="${annulus.id}">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        `;
                    }
                    
                    annulusList.appendChild(annulusElement);
                });
                
                // Add delete event listeners
                document.querySelectorAll('.delete-annulus').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const id = parseInt(this.dataset.id);
                        annulusElements = annulusElements.filter(annulus => annulus.id !== id);
                        updateAnnulusList();
                        generateBorehole();
                    });
                });
                
                // Add annulus type change listeners in edit mode
                if (isEditMode) {
                    document.querySelectorAll('select[data-property="annulusType"]').forEach(select => {
                        select.addEventListener('change', function() {
                            const selectedOption = this.options[this.selectedIndex];
                            if (selectedOption.dataset.color) {
                                const id = parseInt(this.dataset.id);
                                const annulus = annulusElements.find(a => a.id === id);
                                if (annulus) {
                                    annulus.color = selectedOption.dataset.color;
                                }
                                // Update the color input
                                const colorInput = document.querySelector(`input[data-id="${id}"][data-property="color"]`);
                                if (colorInput) {
                                    colorInput.value = selectedOption.dataset.color;
                                }
                            }
                        });
                    });
                }
            }
            
            // Generate the borehole visualization
            function generateBorehole() {
                // Clear existing borehole
                geologyLeft.innerHTML = '';
                annulusConstruction.innerHTML = '';
                boreConstruction.innerHTML = '';
                waterLevel.innerHTML = '';
                geologyRight.innerHTML = '';
                depthScale.innerHTML = '';
                groundLevel.innerHTML = '';
                
                // Update total depth display
                totalDepthSpan.textContent = `Total depth: ${totalHoleDepth} m`;
                
                // Find the minimum depth (for headworks that might be above ground)
                let minDepth = 0;
                constructionElements.forEach(construction => {
                    if (construction.fromDepth < minDepth) minDepth = construction.fromDepth;
                    if (construction.toDepth < minDepth) minDepth = construction.toDepth;
                });
                
                // Calculate total height needed (from minDepth to totalHoleDepth)
                const depthRange = totalHoleDepth - minDepth;
                const containerHeight = depthRange * 2 * segmentHeight;
                
                // Set container heights
                boreholeContainer.style.height = `${containerHeight}px`;
                geologyLeft.style.height = `${containerHeight}px`;
                annulusConstruction.style.height = `${containerHeight}px`;
                boreConstruction.style.height = `${containerHeight}px`;
                waterLevel.style.height = `${containerHeight}px`;
                geologyRight.style.height = `${containerHeight}px`;
                depthScale.style.height = `${containerHeight}px`;
                
                // Create ground level indicator (at 0m)
                const groundLevelPosition = (0 - minDepth) * 2 * segmentHeight;
                const groundLevelLine = document.createElement('div');
                groundLevelLine.className = 'ground-level';
                groundLevelLine.style.top = `${groundLevelPosition}px`;
                
                const groundLevelLabel = document.createElement('div');
                groundLevelLabel.className = 'ground-level-label';
                groundLevelLabel.style.top = `${groundLevelPosition}px`;
                groundLevelLabel.textContent = 'Ground Level (0m)';
                
                groundLevel.appendChild(groundLevelLine);
                groundLevel.appendChild(groundLevelLabel);
                
                // Create depth markers (every 10m)
                for (let i = Math.ceil(minDepth / 10) * 10; i <= totalHoleDepth; i += 10) {
                    const markerPosition = (i - minDepth) * 2 * segmentHeight;
                    const marker = document.createElement('div');
                    marker.className = 'depth-marker';
                    marker.style.top = `${markerPosition}px`;
                    marker.textContent = `${i}`;
                    depthScale.appendChild(marker);
                }
                
                // Create geology segments (left side)
                for (let i = 0; i < depthRange * 2; i++) {
                    const currentDepth = minDepth + (i * 0.5);
                    const segment = document.createElement('div');
                    segment.className = 'layer-segment';
                    segment.style.height = `${segmentHeight}px`;
                    
                    // Find which layer this segment belongs to
                    const matchingLayer = layers.find(layer => 
                        currentDepth >= layer.fromDepth && currentDepth < layer.toDepth
                    );
                    
                    if (matchingLayer) {
                        segment.style.backgroundColor = hexToRgba(matchingLayer.color, 0.8);
                    } else {
                        segment.style.backgroundColor = 'rgba(243, 244, 246, 0.8)';
                    }
                    
                    geologyLeft.appendChild(segment);
                }
                
                // Create geology segments (right side)
                for (let i = 0; i < depthRange * 2; i++) {
                    const currentDepth = minDepth + (i * 0.5);
                    const segment = document.createElement('div');
                    segment.className = 'layer-segment';
                    segment.style.height = `${segmentHeight}px`;
                    
                    // Find which layer this segment belongs to
                    const matchingLayer = layers.find(layer => 
                        currentDepth >= layer.fromDepth && currentDepth < layer.toDepth
                    );
                    
                    if (matchingLayer) {
                        segment.style.backgroundColor = hexToRgba(matchingLayer.color, 0.8);
                        
                        // Add right label for the layer (only at the middle of the layer)
                        const layerMiddleDepth = (matchingLayer.fromDepth + matchingLayer.toDepth) / 2;
                        if (Math.abs(currentDepth - layerMiddleDepth) < 0.25) {
                            const rightLabel = document.createElement('div');
                            rightLabel.className = 'right-label';
                            rightLabel.style.top = `${i * segmentHeight}px`;
                            rightLabel.textContent = `${matchingLayer.materialType}`;
                            
                            // Add depth range label
                            const depthLabel = document.createElement('div');
                            depthLabel.className = 'text-xs text-gray-500';
                            depthLabel.textContent = `${matchingLayer.fromDepth}m - ${matchingLayer.toDepth}m`;
                            rightLabel.appendChild(depthLabel);
                            
                            geologyRight.appendChild(rightLabel);
                        }
                    } else {
                        segment.style.backgroundColor = 'rgba(243, 244, 246, 0.8)';
                    }
                    
                    geologyRight.appendChild(segment);
                }
                
                // Add annulus construction elements (wider than bore construction)
                annulusElements.forEach(annulus => {
                    const fromPosition = (annulus.fromDepth - minDepth) * 2 * segmentHeight;
                    const height = (annulus.toDepth - annulus.fromDepth) * 2 * segmentHeight;
                    
                    if (height <= 0) return;
                    
                    const annulusContainer = document.createElement('div');
                    annulusContainer.className = `absolute ${getAnnulusPatternClass(annulus.annulusType)}`;
                    annulusContainer.style.top = `${fromPosition}px`;
                    annulusContainer.style.height = `${height}px`;
                    annulusContainer.style.width = '100px';
                    annulusContainer.style.left = '50%';
                    annulusContainer.style.transform = 'translateX(-50%)';
                    annulusContainer.style.backgroundColor = annulus.color;
                    annulusContainer.style.borderLeft = '2px solid rgba(0,0,0,0.2)';
                    annulusContainer.style.borderRight = '2px solid rgba(0,0,0,0.2)';
                    annulusContainer.style.zIndex = '1';
                    
                    // Add annulus label in the middle of the element
                    const label = document.createElement('div');
                    label.className = 'segment-label';
                    label.textContent = annulus.annulusType;
                    annulusContainer.appendChild(label);
                    
                    annulusConstruction.appendChild(annulusContainer);
                });
                
                // Add water level if specified
                if (waterDepth !== null && waterDepth < totalHoleDepth) {
                    const fromPosition = (waterDepth - minDepth) * 2 * segmentHeight;
                    const height = (totalHoleDepth - waterDepth) * 2 * segmentHeight;
                    
                    if (height > 0) {
                        const waterContainer = document.createElement('div');
                        waterContainer.className = 'water-level';
                        waterContainer.style.top = `${fromPosition}px`;
                        waterContainer.style.height = `${height}px`;
                        waterContainer.style.backgroundColor = 'rgba(0, 119, 255, 0.3)';
                        waterContainer.style.borderLeft = '1px solid rgba(0, 119, 255, 0.7)';
                        waterContainer.style.borderRight = '1px solid rgba(0, 119, 255, 0.7)';
                        waterContainer.style.zIndex = '4';
                        
                        // Add water level label at the exact water depth
                        const label = document.createElement('div');
                        label.className = 'water-level-label';
                        label.style.top = '0px';
                        label.textContent = 'Water Level';
                        waterContainer.appendChild(label);
                        
                        waterLevel.appendChild(waterContainer);
                    }
                }
                
                // Add construction elements (center)
                constructionElements.forEach(construction => {
                    const fromPosition = (construction.fromDepth - minDepth) * 2 * segmentHeight;
                    const height = (construction.toDepth - construction.fromDepth) * 2 * segmentHeight;
                    
                    if (height <= 0) return;
                    
                    const constructionContainer = document.createElement('div');
                    constructionContainer.className = `absolute ${getConstructionPatternClass(construction.constructionType)}`;
                    constructionContainer.style.top = `${fromPosition}px`;
                    constructionContainer.style.height = `${height}px`;
                    constructionContainer.style.width = '60px';
                    constructionContainer.style.left = '50%';
                    constructionContainer.style.transform = 'translateX(-50%)';
                    constructionContainer.style.backgroundColor = construction.color;
                    constructionContainer.style.borderLeft = '2px solid rgba(0,0,0,0.2)';
                    constructionContainer.style.borderRight = '2px solid rgba(0,0,0,0.2)';
                    constructionContainer.style.zIndex = '2';
                    
                    // Add construction label in the middle of the construction element
                    const label = document.createElement('div');
                    label.className = 'segment-label';
                    label.textContent = construction.constructionType;
                    constructionContainer.appendChild(label);
                    
                    boreConstruction.appendChild(constructionContainer);
                });
            }
            
            // Helper function to get pattern class based on construction type
            function getConstructionPatternClass(constructionType) {
                switch(constructionType) {
                    case 'Headworks': return 'headworks-pattern';
                    case 'Surface Casing': return 'surface-casing-pattern';
                    case 'Blank Casing': return 'blank-casing-pattern';
                    case 'Slotted Casing 1': return 'slotted-casing-1-pattern';
                    case 'Screens': return 'screens-pattern';
                    case 'Slotted Casing 2': return 'slotted-casing-2-pattern';
                    case 'Sump': return 'sump-pattern';
                    case 'Endcap': return 'endcap-pattern';
                    default: return '';
                }
            }
            
            // Helper function to get pattern class based on annulus type
            function getAnnulusPatternClass(annulusType) {
                switch(annulusType) {
                    case 'Grout': return 'grout-pattern';
                    case 'Gravel': return 'gravel-pattern';
                    case 'Bentonite': return 'bentonite-pattern';
                    default: return '';
                }
            }
            
            // Helper function to convert hex color to rgba with transparency
            function hexToRgba(hex, alpha) {
                const r = parseInt(hex.slice(1, 3), 16);
                const g = parseInt(hex.slice(3, 5), 16);
                const b = parseInt(hex.slice(5, 7), 16);
                
                return `rgba(${r}, ${g}, ${b}, ${alpha})`;
            }
            
            // Initialize the borehole display
            generateBorehole();
        });
    </script>
</body>
</html>
